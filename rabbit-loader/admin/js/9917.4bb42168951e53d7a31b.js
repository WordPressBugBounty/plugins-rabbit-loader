"use strict";(this.webpackChunkRLAdmin=this.webpackChunkRLAdmin||[]).push([[9917],{48460:(e,t,a)=>{e.exports=a.p+"e503aec708eb2a9768c7.svg"},49917:(e,t,a)=>{a.r(t),a.d(t,{default:()=>q});var n=a(6530),l=a(47086),c=a(65990),r=a(15189),i=a(12302),o=a(37529),s=a(24525),u=a(81550),m=a(61580),d=a(18088),h=a(55106),p=a(983),R=a(16481),A=a(78722),g=a(2245),E=a(98268),v=a(77776),w=a(31085);const b=(0,v.A)((0,w.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var f=a(95374),y=a(69597),D=a(96809),x=a(72102);const P=(0,v.A)((0,w.jsx)("path",{d:"M12 3 1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9zm6.82 6L12 12.72 5.18 9 12 5.28zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73z"}),"SchoolOutlined"),S=(0,v.A)((0,w.jsx)("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92zM17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29m-3.6 3.19L3 17.25V21h3.75L17.81 9.94z"}),"EditOutlined"),I=(0,v.A)((0,w.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2zM9 9h6c.55 0 1 .45 1 1v8c0 .55-.45 1-1 1H9c-.55 0-1-.45-1-1v-8c0-.55.45-1 1-1m6.5-5-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1z"}),"DeleteOutlineRounded"),C=(0,v.A)((0,w.jsx)("path",{d:"m7 14 5-5 5 5z"}),"ArrowDropUp"),L=(0,v.A)((0,w.jsx)("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDown");var z=a(14041),k=a(48460),U=a(28804),M=a(79744),j=function(e){return e[e.Up=0]="Up",e[e.Down=1]="Down",e}(j||{});function q(e){var t;let{domainID:a,pageRules:v,isLoading:w,defaultPageRule:q}=e;const H=(0,n.A)(),[O,V]=(0,z.useState)(5),[_,N]=(0,z.useState)(0),[F,B]=(0,z.useState)(void 0);async function G(e,t){if(!v)return;B(e);const n=[...v];if(t===j.Up){if(e<=0||e>=v.length)return void B(void 0);[n[e],n[e-1]]=[n[e-1],n[e]]}else if(t===j.Down){if(e<0||e>=v.length-1)return void B(void 0);[n[e],n[e+1]]=[n[e+1],n[e]]}const l=[];n.forEach(e=>{l.push(e.pageRuleID)}),q&&l.push(q.pageRuleID);const c=await async function(e,t){const a=new x.I.UpdatePageRulesPriorityRequest({pageRuleIDs:t});return await(0,D.cs)(a,{pathVars:{"{domain_id}":e}},(0,y.w9)(!1),(0,y.N4)())}(a,l);200===c&&(f.b.emit(f.B.PriorityChanged,[...n]),(0,U.ck)("adv_rule_priority_changed")),B(void 0)}return React.createElement(r.A,{sx:{mt:5,mb:3}},React.createElement(i.A,{sx:{py:3}},React.createElement(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"}},React.createElement(r.A,{sx:{ml:4,maxWidth:"70%"}},React.createElement(c.A,{variant:"h5",color:"textPrimary"},"Override Global Settings"),React.createElement(c.A,{variant:"body2",sx:{mb:2},color:"textSecondary"},"You can create rules to best optimize the various pages served from your domain. RabbitLoader compares every page and assets served with the path patterns in your rules to optimize the performance. Arrange rules in the order in which you want RabbitLoader to evaluate them.")),React.createElement(r.A,{sx:{mr:4,mb:4,display:"flex",columnGap:3}},React.createElement(o.A,{variant:"contained",onClick:()=>f.b.emit(f.B.AddOrUpdatePageRuleAction),color:"primary"},React.createElement(b,null)," Add Rule"),React.createElement(o.A,{variant:"outlined",href:"https://rabbitloader.com/kb/setting-page-rules/",target:"__blank"},React.createElement(P,{sx:{mr:1}})," Rule Help"))),React.createElement(s.A,null,React.createElement(u.A,null,React.createElement(m.A,null,React.createElement(d.A,{sx:{pl:3}},React.createElement(h.A,{colSpan:8},"Sequence"," ",React.createElement(l.A,{title:"Rules are compared in ascending order of their matching sequence until a match is found. So a rule with sequence 0 will be compared first when a URL is optimized. If the rule matches, no further rules with higher sequence number will be evaluated for the URL. Following the same convention, the * rule should come at the last and it should have the highest sequence."},React.createElement(E.A,null))),React.createElement(h.A,{colSpan:8},"URL Pattern"),React.createElement(h.A,{colSpan:8},"Cache"),React.createElement(h.A,null,"Actions"))),React.createElement(p.A,null,w&&void 0===v?React.createElement(d.A,null,React.createElement(h.A,{colSpan:25,align:"center",sx:{height:200}},React.createElement(R.A,null))):React.createElement(React.Fragment,null,0===(null==v?void 0:v.length)&&React.createElement(d.A,null,React.createElement(h.A,{colSpan:25,height:300,align:"center"},React.createElement("img",{src:k,alt:"No Data Found",style:{width:160}}),React.createElement(c.A,{variant:"body1"},"No page rule has been set yet."))),null==v?void 0:v.slice(_*O,_*O+O).map((e,t)=>React.createElement(d.A,{key:"".concat(e.pageRuleID),sx:{pl:3,opacity:F===t?"60%":"100%"}},React.createElement(h.A,{colSpan:8},t+1),React.createElement(h.A,{colSpan:8},React.createElement(l.A,{title:"The rule will apply to all pages matching this pattern"},React.createElement(c.A,null,e.pathPattern))),React.createElement(h.A,{colSpan:8},(e=>{const t=e===x.I.ContentNature.FullDynamic?"Disabled":"Enabled",a="Cache is ".concat(t," for pages matching this rule");return React.createElement(l.A,{title:a},React.createElement(c.A,null,t))})(e.contentNature)),React.createElement(h.A,null,React.createElement(l.A,{title:"Modify optimization settings"},React.createElement(A.A,{onClick:()=>f.b.emit(f.B.AddOrUpdatePageRuleAction,e)},React.createElement(S,{sx:{color:H.palette.primary.main}}))),React.createElement(l.A,{title:"Delete rule"},React.createElement(A.A,{"aria-label":"delete",onClick:async()=>{B(t);const n=await async function(e){let{pageRuleID:t,domainID:a}=e;const n=new x.I.DeletePageRuleRequest({pageRuleID:t});return await(0,D.jY)(n,{pathVars:{"{domain_id}":a}},(0,y.w9)(!1),(0,y.N4)())}({domainID:a,pageRuleID:e.pageRuleID});200===n?((0,M.v)("Successfully deleted page rule",n,"success"),f.b.emit(f.B.RulesChanged)):(0,M.v)("Failed to delete page rule",n,"warning"),B(void 0)}},React.createElement(I,{style:{color:H.palette.error.main}}))),React.createElement(l.A,{title:"Move up for earlier evaluation"},React.createElement(A.A,{onClick:()=>G(t,j.Up)},React.createElement(C,null))),React.createElement(l.A,{title:"Move down for later evaluation"},React.createElement(A.A,{onClick:()=>G(t,j.Down)},React.createElement(L,null)))))))))),React.createElement(g.A,{page:_,rowsPerPage:O,component:"div",count:null!==(t=null==v?void 0:v.length)&&void 0!==t?t:0,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:e=>V(e.target.value),onPageChange:(e,t)=>N(t)})))}}}]);