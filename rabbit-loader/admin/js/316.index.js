"use strict";(this.webpackChunkRLAdmin=this.webpackChunkRLAdmin||[]).push([[316],{67485:(e,t,a)=>{a.d(t,{wT:()=>p});var n=a(56770),i=a(2784),o=a(27379),l=a(87037),r=a(86769),c=a(8120),s=a(65992),m=a(47591);const u=(0,s.ZP)(n.pk)((e=>{let{theme:t}=e;const a="light"===t.palette.mode;return{"& #notistack-snackbar":{...t.typography.subtitle2,padding:0,flexGrow:1},"&.notistack-MuiContent":{color:t.palette.text.primary,boxShadow:t.customShadows.z8,borderRadius:t.shape.borderRadius,padding:t.spacing(.5,2,.5,.5),backgroundColor:t.palette.background.paper},"&.notistack-MuiContent-default":{padding:t.spacing(1,2,1,1),color:a?t.palette.common.white:t.palette.grey[800],backgroundColor:a?t.palette.grey[800]:t.palette.common.white}}})),d=(0,s.ZP)("span")((e=>{let{color:t,theme:a}=e;return{width:44,height:44,display:"flex",alignItems:"center",justifyContent:"center",marginRight:a.spacing(1.5),color:a.palette[t].main,borderRadius:a.shape.borderRadius,backgroundColor:(0,m.Fq)(a.palette[t].main,.16)}}));function p(e){let{children:t}=e;const a="rtl"===(0,c.K$)().themeDirection,s=(0,i.useRef)(null);return i.createElement(n.wT,{ref:s,maxSnack:5,preventDuplicate:!0,SnackbarProps:{style:{zIndex:999999999999}},autoHideDuration:3e3,TransitionComponent:a?o.Z:void 0,variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"},iconVariant:{info:i.createElement(d,{color:"info"},i.createElement(r.Z,{icon:"eva:info-fill",width:24})),success:i.createElement(d,{color:"success"},i.createElement(r.Z,{icon:"eva:checkmark-circle-2-fill",width:24})),warning:i.createElement(d,{color:"warning"},i.createElement(r.Z,{icon:"eva:alert-triangle-fill",width:24})),error:i.createElement(d,{color:"error"},i.createElement(r.Z,{icon:"solar:danger-bold",width:24}))},Components:{default:u,info:u,success:u,warning:u,error:u},action:e=>i.createElement(l.Z,{size:"small",onClick:()=>(0,n.sy)(e),sx:{p:.5}},i.createElement(r.Z,{width:16,icon:"mingcute:close-line"})),style:{zIndex:1e21}},t)}},75193:(e,t,a)=>{a.r(t),a.d(t,{PageRule:()=>Pe});var n=a(2784),i=a(17029),o=a(73454),l=a(1998),r=a(54504);let c=function(e){return e.PriorityChanged="priority-change",e.AddOrUpdatePageRuleAction="add-or-delete-rule",e.RulesChanged="rules-changed",e}({});const s=(0,r.Z)();var m=a(40920),u=a(78027),d=a(22409),p=a(82074),g=a(23468),R=a(3643),h=a(71271),f=a(84421);function E(e){let{index:t,value:a,children:n}=e;return React.createElement("div",{role:"tabpanel",hidden:a!==t,id:"simple-tabpanel-".concat(t),"aria-labelledby":"simple-tab-".concat(t)},a===t&&React.createElement(d.Z,{sx:{py:3}},n))}var y=a(20828),v=a(18149),b=a.n(v),Z=a(49850);async function x(e,t){const a=new Z.Q.SavePageRuleRequest({pageRule:t});return await(0,l.iD)(a,{pathVars:{"{domain_id}":e}},(0,o.YT)(!1),(0,o.ZQ)())}var z=a(37046),w=a(87729),S=a(54432),C=a(27939),P=a(39956),k=a(68019);function D(){return D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},D.apply(this,arguments)}const I=function(e){let{value:t,title:a,subtitle:i,tooltip:o,onChange:l,placeholder:r,disabled:c}=e;const[s,m]=(0,n.useState)(""),u=(0,n.useMemo)((()=>t&&t.trim()?t.split(" "):[]),[t]),g=e=>{if(" "===e.key&&s.trim()){e.preventDefault();const t=s.trim(),a=[...u,t];l(a.join(" ")),m("")}};return n.createElement(n.Fragment,null,n.createElement(d.Z,{sx:{display:"flex",columnGap:1,alignItems:"center",mb:2}},n.createElement(d.Z,null,n.createElement(p.Z,{variant:"subtitle1",color:"textPrimary"},a),o&&n.createElement(S.Z,{title:o},n.createElement(k.Z,{sx:{height:20,width:20}})),n.createElement(p.Z,{variant:"caption",color:"textSecondary"},i))),n.createElement(C.Z,{multiple:!0,freeSolo:!0,disabled:c,options:[],value:u,onChange:(e,t)=>{l(t.join(" "))},inputValue:s,onInputChange:(e,t)=>m(t),renderInput:e=>n.createElement(P.Z,D({},e,{variant:"outlined",placeholder:r,onKeyDown:g}))}))};var j=a(26715),F=a(89025);function T(){return T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},T.apply(this,arguments)}const Q=function(e){let{sx:t,title:a,tooltip:n,subtitle:i,onUpdate:o,SwitchProps:l}=e;return React.createElement(d.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",...t}},React.createElement(d.Z,null,React.createElement(d.Z,{sx:{display:"flex",columnGap:1}},React.createElement(p.Z,{variant:"subtitle1",color:"textPrimary"},a),n&&React.createElement(S.Z,{title:n},React.createElement(F.Z,{sx:{height:20,width:20}}))),React.createElement(p.Z,{variant:"caption",color:"textSecondary"},i)),React.createElement(j.Z,T({},l,{onChange:(e,t)=>{o(t)}})))},U=function(e){let{pageRule:t,setPageRule:a}=e;return React.createElement(z.Z,null,React.createElement(Q,{title:"Generate Critical CSS",subtitle:"Load critical CSS first to render above-the-fold, then defer non-critical CSS.",onUpdate:e=>{const n=t.clone();n.optimizations.css||(n.optimizations.css=new Z.Q.CSS),n.optimizations.css.defer=e,a(n)},SwitchProps:{checked:!!t.optimizations.css&&t.optimizations.css.defer}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(Q,{title:"Minify CSS",subtitle:"External CSS files and inline styles tags compressed for up to 20% reduction in file size.",onUpdate:e=>{const n=t.clone();n.optimizations.css||(n.optimizations.css=new Z.Q.CSS),n.optimizations.css.minify=e,a(n)},SwitchProps:{checked:!!t.optimizations.css&&t.optimizations.css.minify,disabled:!t.optimizations.css||!t.optimizations.css.defer}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(Q,{title:"Optimize Web fonts",subtitle:"Lazy load web fonts to enhance FCP performance.",onUpdate:e=>{const n=t.clone();n.optimizations.webFont||(n.optimizations.webFont=new Z.Q.WebFont),n.optimizations.webFont.defer=e,a(n)},SwitchProps:{checked:!!t.optimizations.webFont&&t.optimizations.webFont.defer,disabled:!t.optimizations.css||!t.optimizations.css.defer}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(I,{title:"Skip lazy load for these CSS",placeholder:"CSS file names or inline ID seperated by space",subtitle:"Add CSS file paths or inline CSS IDs below to be excluded from lazy loading. Separate multiple strings with spaces.",value:t.optimizations.css?t.optimizations.css.skipDeferTokens:void 0,disabled:!t.optimizations.css||!t.optimizations.css.defer,onChange:e=>{const n=t.clone();n.optimizations.css||(n.optimizations.css=new Z.Q.CSS),n.optimizations.css.skipDeferTokens=e,a(n)}}))},L=function(e){let{pageRule:t,setPageRule:a}=e;return React.createElement(z.Z,null,React.createElement(Q,{title:"Optimize JavaScript",subtitle:"Delay JavaScript execution to boost PageSpeed Score.",onUpdate:e=>{const n=t.clone();n.optimizations.js||(n.optimizations.js=new Z.Q.JS),n.optimizations.js.defer=e,a(n)},SwitchProps:{checked:!!t.optimizations.js&&t.optimizations.js.defer}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(Q,{title:"Delay Loading of Ads and Analytics Scripts",subtitle:"Delay ads and analytics JavaScript to improve PageSpeed Score, it may impact ad impressions and revenue.",onUpdate:e=>{const n=t.clone();n.optimizations.ads||(n.optimizations.ads=new Z.Q.Ads),n.optimizations.ads.defer=e,a(n)},SwitchProps:{checked:!!t.optimizations.ads&&t.optimizations.ads.defer,disabled:!t.optimizations.js||!t.optimizations.js.defer}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(Q,{title:"Prioritize Speed Score Over Slider Loading",subtitle:"Delay slider JavaScript execution until after page load. This may cause sliders to appear later but improves PageSpeed score.",onUpdate:e=>{const n=t.clone();n.optimizations.js||(n.optimizations.js=new Z.Q.JS),n.optimizations.js.sliderFirst=!e,a(n)},SwitchProps:{checked:!t.optimizations.js||!t.optimizations.js.sliderFirst,disabled:!t.optimizations.js||!t.optimizations.js.defer}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(Q,{title:"Compress inline JS and JS files",subtitle:"Compress inline JS and files to reduce transfer size by up to 20%.",onUpdate:e=>{const n=t.clone();n.optimizations.js||(n.optimizations.js=new Z.Q.JS),n.optimizations.js.minify=e,a(n)},SwitchProps:{checked:!!t.optimizations.js&&t.optimizations.js.minify,disabled:!t.optimizations.js||!t.optimizations.js.defer}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(I,{title:"Skip lazy load for JS",subtitle:"Add JS file paths or inline JS IDs below to exclude from optimization. Separate multiple strings with spaces. Note: Excluding files with dependencies may break the website.",placeholder:"JS file names or IDs separated by space",value:t.optimizations.js?t.optimizations.js.skipDeferTokens:"",disabled:!t.optimizations.js||!t.optimizations.js.defer,onChange:e=>{const n=t.clone();n.optimizations.js||(n.optimizations.js=new Z.Q.JS),n.optimizations.js.skipDeferTokens=e,a(n)}}))},A=function(e){let{pageRule:t,setPageRule:a}=e;return React.createElement(z.Z,null,React.createElement(Q,{title:"Optimize image loading",subtitle:"Display above-the-fold images immediately, lazy load images below the fold.",onUpdate:e=>{const n=t.clone();n.optimizations.image||(n.optimizations.image=new Z.Q.Image),n.optimizations.image.lazy=e,a(n)},SwitchProps:{checked:!!t.optimizations.image&&t.optimizations.image.lazy}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(Q,{title:"Convert images to next-gen formats",subtitle:"Convert PNG/JPEG to WebP/AVIF for 30% faster load times. Original formats shown if WebP isn't supported.",onUpdate:e=>{const n=t.clone();n.optimizations.image||(n.optimizations.image=new Z.Q.Image),n.optimizations.image.webPA=e,a(n)},SwitchProps:{checked:!!t.optimizations.image&&t.optimizations.image.webPA,disabled:!t.optimizations.image||!t.optimizations.image.lazy}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(Q,{title:"Lazy load background images",subtitle:"Lazy load background images to improve performance.",onUpdate:e=>{const n=t.clone();n.optimizations.image||(n.optimizations.image=new Z.Q.Image),n.optimizations.image.lazyBack=e,a(n)},SwitchProps:{checked:!!t.optimizations.image&&t.optimizations.image.lazyBack,disabled:!t.optimizations.image||!t.optimizations.image.lazy}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(Q,{title:"Add missing width/height attributes",subtitle:"Automatically add missing image dimensions to prevent layout shift when lazy loaded.",onUpdate:e=>{const n=t.clone();n.optimizations.image||(n.optimizations.image=new Z.Q.Image),n.optimizations.image.lqip=e,a(n)},SwitchProps:{checked:!!t.optimizations.image&&t.optimizations.image.lqip,disabled:!t.optimizations.image||!t.optimizations.image.lazy}}))};var N=a(43141),O=a(68491);const _=function(e){let{pageRule:t,setPageRule:a}=e;return React.createElement(React.Fragment,null,React.createElement(z.Z,null,React.createElement(Q,{title:"Lazy Load Iframes/YouTube Videos",subtitle:"Lazy load embedded media (YouTube, Maps, iframes) and use a facet if available.",onUpdate:e=>{const n=t.clone();n.optimizations.iFrame||(n.optimizations.iFrame=new Z.Q.IFrame),n.optimizations.iFrame.lazy=e,a(n)},SwitchProps:{checked:!!t.optimizations.iFrame&&t.optimizations.iFrame.lazy}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(Q,{title:"Lazy Load Vimeo Videos",subtitle:"This will work only if the domain-level privacy is off for the video.",onUpdate:e=>{const n=t.clone();n.optimizations.iFrame||(n.optimizations.iFrame=new Z.Q.IFrame),n.optimizations.iFrame.vimeo=e,a(n)},SwitchProps:{checked:!!t.optimizations.iFrame&&t.optimizations.iFrame.vimeo,disabled:!t.optimizations.iFrame||!t.optimizations.iFrame.lazy}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(Q,{title:"Compress Final HTML",subtitle:"Compress final HTML by removing unnecessary characters and whitespace for faster transfer.",onUpdate:e=>{const n=t.clone();n.optimizations.html||(n.optimizations.html=new Z.Q.HTML),n.optimizations.html.minify=e,a(n)},SwitchProps:{checked:!!t.optimizations.html&&t.optimizations.html.minify}}),React.createElement(w.Z,{sx:{my:1}}),React.createElement(p.Z,{sx:{whiteSpace:"nowrap"},variant:"subtitle1"},"Cache TTL"),React.createElement(p.Z,{variant:"caption",sx:{mb:2}},"The maximum duration for which the cache remains valid."),React.createElement(N.Z,{value:t.optimizations.html?t.optimizations.html.maxAgeSeconds:0,fullWidth:!0,displayEmpty:!0,onChange:e=>{const n=t.clone();n.optimizations.html||(n.optimizations.html=new Z.Q.HTML),n.optimizations.html.maxAgeSeconds=e.target.value,a(n)}},React.createElement(O.Z,{value:0,sx:{color:"GrayText"}},"Based on headers from origin."),React.createElement(O.Z,{value:600,sx:{color:"GrayText"}},"10 minutes"),React.createElement(O.Z,{value:3600,sx:{color:"GrayText"}},"1 hour"),React.createElement(O.Z,{value:216e3,sx:{color:"GrayText"}},"6 hours"),React.createElement(O.Z,{value:86400,sx:{color:"GrayText"}},"1 day"),React.createElement(O.Z,{value:172800,sx:{color:"GrayText"}},"2 days"),React.createElement(O.Z,{value:604800,sx:{color:"GrayText"}},"7 days"),React.createElement(O.Z,{value:2592e3,sx:{color:"GrayText"}},"1 month"))))};var M=a(56770),G=a(72547);function J(e){let{pageRule:t,miniMode:a,domainID:i,isLoading:o,openAddRule:l,overrideRules:r,isPageRulesListModified:v}=e;const[Z,z]=(0,n.useState)(0),[w,S]=(0,n.useState)(t),[C,P]=(0,n.useState)(!1),k=(0,m.Z)(),D=(0,n.useMemo)((()=>a?React.createElement(u.Z,{href:"https://rabbitloader.com/account/#rules?utm_medium=plugin&utm_content=advance+rules",target:"_blank",sx:{ml:1}},"advance rules"):r.length<=0?React.createElement(d.Z,{onClick:l,sx:{ml:1,color:"#6B71FB",textDecoration:"underline","&:hover":{cursor:"pointer"}}},"advance rules"):void 0),[a,r]),I=(0,n.useMemo)((()=>!v&&!b()(w,t)),[v,w,t]),j=async function(){P(!0),(0,G.Tf)("default_rule_saved"),200===await x(i,w)&&((0,M.yv)("Successfully updated optimization rule.",{variant:"success"}),(0,M.yv)("Make sure to purge the cache for changes to be immediately effective",{variant:"info",autoHideDuration:null}),s.emit(c.RulesChanged)),P(!1)},T=(0,n.useMemo)((()=>I?React.createElement(d.Z,{sx:{display:"flex",flexDirection:"row",justifyItems:"center",columnGap:1,alignItems:"center"}},React.createElement(y.Z,{loading:C,onClick:j,variant:"contained",color:"primary",sx:{mb:2}},"Save"),React.createElement(p.Z,{variant:"body2",sx:{color:"text.secondary",mb:2}},"You need to purge the cache after saving the rule for immediate effect.")):null),[I,C,j]),Q=(0,n.useMemo)((()=>o||!w?React.createElement(d.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:294}},React.createElement(g.Z,{sx:{width:"100%"}})):React.createElement(React.Fragment,null,React.createElement(R.Z,{value:Z,onChange:(e,t)=>z(t),variant:"fullWidth"},React.createElement(h.Z,{label:"Image",value:0}),React.createElement(h.Z,{label:"CSS",value:1}),React.createElement(h.Z,{label:"JS",value:2}),React.createElement(h.Z,{label:"Others",value:3})),React.createElement(E,{index:0,value:Z},React.createElement(A,{pageRule:w,setPageRule:S})),React.createElement(E,{index:1,value:Z},React.createElement(U,{pageRule:w,setPageRule:S})),React.createElement(E,{index:2,value:Z},React.createElement(L,{pageRule:w,setPageRule:S})),React.createElement(E,{index:3,value:Z},React.createElement(_,{pageRule:w,setPageRule:S})))),[o,w,Z]);return(0,n.useEffect)((()=>{t&&S(t)}),[t]),React.createElement(f.Z,{sx:{p:3,minHeight:430,mb:a||r.length<=0?3:0}},React.createElement(React.Fragment,null,React.createElement(d.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"}},React.createElement(d.Z,null,React.createElement(p.Z,{variant:"h5",color:"textPrimary"},"Global Optimization"),React.createElement(p.Z,{variant:"body2",sx:{mb:2},color:"textSecondary"},"Optimization rules are applied globally to all pages of the website, except for the Admin panel of WordPress."))),Q,T),(a||r.length<=0)&&React.createElement(d.Z,{sx:{px:3,py:1.5,bgcolor:k.palette.grey[200],borderRadius:2,display:"flex",alignItems:"center","&:hover":{cursor:"pointer"}},onClick:()=>(0,G.Tf)("adv_rule_expanded")},React.createElement(F.Z,{sx:{mr:1}}),"Optimize or exclude optimizations for any page or page group using",D))}var q=a(50118),W=a(71343),H=a(29534),V=a(77160),Y=a(89991),B=a(40874),K=a(36269);const $=["Path Pattern","CSS","JS","Image","HTML, iFrame & Cache"],X={[Z.Q.ContentNature.UNDEFINED_CONTENT_NATURE]:"",[Z.Q.ContentNature.Static]:"The content served is same for everyone. It is not based on cookies or session. In this case, RabbitLoader allows you to optimize and cache the content at CDN to boost the speed. Blog articles or the home page are the perfect examples. This can give you best speed.",[Z.Q.ContentNature.SemiDynamic]:"",[Z.Q.ContentNature.FullDynamic]:"RabbitLoader will not do any optimizations or cache the content. Admin panels are best example for this category."};function ee(e){const[t,a]=(0,n.useState)(e.pageRule),[i,o]=(0,n.useState)(0),[l,r]=(0,n.useState)(!1),[m,u]=(0,n.useState)(!1);return(0,n.useEffect)((()=>a(e.pageRule)),[e]),React.createElement(q.Z,{open:e.open,sx:{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},onClose:e.onClose},React.createElement(f.Z,{sx:{p:3,width:800}},React.createElement(d.Z,{sx:{display:"flex",justifyContent:"space-between"}},React.createElement(p.Z,{variant:"h5"},e.title),React.createElement(W.Z,{onClick:e.onClose},React.createElement(K.Z,null))),React.createElement(H.Z,{activeStep:i,alternativeLabel:!0,sx:{mt:4,width:"100%"}},$.map((e=>React.createElement(V.Z,{key:e,disabled:t.contentNature===Z.Q.ContentNature.FullDynamic},React.createElement(Y.Z,null,e))))),React.createElement(d.Z,{sx:{mt:3,px:3}},0===i&&React.createElement(React.Fragment,null,React.createElement(d.Z,{sx:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",columnGap:5}},React.createElement(p.Z,{sx:{whiteSpace:"nowrap",flexShrink:0}},"URL Pattern:"," "),React.createElement(P.Z,{fullWidth:!0,value:t.pathPattern,error:m,helperText:m?"URL Pattern is required.":"",placeholder:"/blog, /account/*, etc...",sx:{width:"80%"},onChange:e=>{""===e.target.value?u(!0):m&&u(!1);const n=t.clone();n.pathPattern=e.target.value,a(n)}})),React.createElement(d.Z,null,React.createElement(d.Z,null,React.createElement(d.Z,{sx:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",columnGap:5,mt:2}},React.createElement(p.Z,{sx:{whiteSpace:"nowrap",flexShrink:0}},"Cache:"," "),React.createElement(N.Z,{value:t.contentNature,fullWidth:!0,sx:{width:"80%"},onChange:e=>{const n=t.clone();n.contentNature=e.target.value,a(n)}},React.createElement(O.Z,{value:Z.Q.ContentNature.Static,sx:{color:"GrayText"}},"Enabled"),React.createElement(O.Z,{value:Z.Q.ContentNature.FullDynamic,sx:{color:"GrayText"}},"Disabled")))),React.createElement(d.Z,{sx:{mt:3}},React.createElement(p.Z,{variant:"caption",sx:{pt:2,color:"GrayText"}},X[t.contentNature])))),1===i&&React.createElement(React.Fragment,null,React.createElement(A,{pageRule:t,setPageRule:a})),2===i&&React.createElement(React.Fragment,null,React.createElement(U,{pageRule:t,setPageRule:a})),3===i&&React.createElement(React.Fragment,null,React.createElement(L,{pageRule:t,setPageRule:a})),4===i&&React.createElement(React.Fragment,null,React.createElement(_,{pageRule:t,setPageRule:a}))),React.createElement(d.Z,{sx:{display:"flex",justifyContent:"end",columnGap:2,mt:2}},React.createElement(B.Z,{onClick:()=>o(i-1),disabled:0===i},"Back"),React.createElement(y.Z,{loading:l,variant:"contained",color:"primary",onClick:async()=>{i===$.length-1||t.contentNature===Z.Q.ContentNature.FullDynamic?await async function(){if(!t.pathPattern||""===t.pathPattern)return o(0),void u(!0);r(!0),await e.onSubmit(t)&&(r(!1),s.emit(c.RulesChanged),e.onClose())}():o(i+1)}},i===$.length-1||t.contentNature===Z.Q.ContentNature.FullDynamic?"Save":"Next"))))}var te=a(87552),ae=a(65738),ne=a(40716),ie=a(64765),oe=a(10475),le=a(3532),re=a(50528),ce=a(93553),se=a(934),me=a(16025),ue=a(1533),de=a(33931),pe=a(25838),ge=a(89621),Re=function(e){return e[e.Up=0]="Up",e[e.Down=1]="Down",e}(Re||{});function he(e){var t;let{domainID:a,pageRules:i,isLoading:r,defaultPageRule:u}=e;const R=(0,m.Z)(),[h,E]=(0,n.useState)(5),[y,v]=(0,n.useState)(0),[b,x]=(0,n.useState)(void 0);async function z(e,t){if(!i)return;x(e);let n=[...i];if(t===Re.Up){if(e<=0||e>=i.length)return void x(void 0);[n[e],n[e-1]]=[n[e-1],n[e]]}else if(t===Re.Down){if(e<0||e>=i.length-1)return void x(void 0);[n[e],n[e+1]]=[n[e+1],n[e]]}const r=[];n.forEach((e=>{r.push(e.pageRuleID)})),u&&r.push(u.pageRuleID);const m=await async function(e,t){const a=new Z.Q.UpdatePageRulesPriorityRequest({pageRuleIDs:t});return await(0,l.UW)(a,{pathVars:{"{domain_id}":e}},(0,o.YT)(!1),(0,o.ZQ)())}(a,r);200===m&&(s.emit(c.PriorityChanged,[...n]),(0,G.Tf)("adv_rule_priority_changed")),x(void 0)}return React.createElement(d.Z,{sx:{mt:5,mb:3}},React.createElement(f.Z,{sx:{py:3}},React.createElement(d.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"}},React.createElement(d.Z,{sx:{ml:4,maxWidth:"70%"}},React.createElement(p.Z,{variant:"h5",color:"textPrimary"},"Override Global Settings"),React.createElement(p.Z,{variant:"body2",sx:{mb:2},color:"textSecondary"},"You can create rules to best optimize the various pages served from your domain. RabbitLoader compares every page and assets served with the path patterns in your rules to optimize the performance. Arrange rules in the order in which you want RabbitLoader to evaluate them.")),React.createElement(d.Z,{sx:{mr:4,mb:4,display:"flex",columnGap:3}},React.createElement(B.Z,{variant:"contained",onClick:()=>s.emit(c.AddOrUpdatePageRuleAction),color:"primary"},React.createElement(ce.Z,null)," Add Rule"),React.createElement(B.Z,{variant:"outlined",href:"https://rabbitloader.com/kb/setting-page-rules/",target:"__blank"},React.createElement(se.Z,{sx:{mr:1}})," Rule Help"))),React.createElement(te.Z,null,React.createElement(ae.Z,null,React.createElement(ne.Z,null,React.createElement(ie.Z,{sx:{pl:3}},React.createElement(oe.Z,{colSpan:8},"Sequence"," ",React.createElement(S.Z,{title:"Rules are compared in ascending order of their matching sequence until a match is found. So a rule with sequence 0 will be compared first when a URL is optimized. If the rule matches, no further rules with higher sequence number will be evaluated for the URL. Following the same convention, the * rule should come at the last and it should have the highest sequence."},React.createElement(F.Z,null))),React.createElement(oe.Z,{colSpan:8},"URL Pattern"),React.createElement(oe.Z,{colSpan:8},"Content Type"),React.createElement(oe.Z,null,"Actions"))),React.createElement(le.Z,null,r&&void 0===i?React.createElement(ie.Z,null,React.createElement(oe.Z,{colSpan:25,align:"center",sx:{height:200}},React.createElement(g.Z,null))):React.createElement(React.Fragment,null,0===(null==i?void 0:i.length)&&React.createElement(ie.Z,null,React.createElement(oe.Z,{colSpan:25,height:300,align:"center"},React.createElement("img",{src:ge,alt:"No Data Found",style:{width:160}}),React.createElement(p.Z,{variant:"body1"},"No page rule has been set yet."))),null==i?void 0:i.slice(y*h,y*h+h).map(((e,t)=>{return React.createElement(ie.Z,{sx:{pl:3,opacity:b===t?"60%":"100%"}},React.createElement(oe.Z,{colSpan:8},t+1),React.createElement(oe.Z,{colSpan:8},e.pathPattern),React.createElement(oe.Z,{colSpan:8},(n=e.contentNature)===Z.Q.ContentNature.Static?"Static":n===Z.Q.ContentNature.FullDynamic?"Full Dynamic":"Unknown"),React.createElement(oe.Z,null,React.createElement(S.Z,{title:"Modify optimization settings"},React.createElement(W.Z,{onClick:()=>s.emit(c.AddOrUpdatePageRuleAction,e)},React.createElement(me.Z,{sx:{color:R.palette.primary.main}}))),React.createElement(S.Z,{title:"Delete rule"},React.createElement(W.Z,{"aria-label":"delete",onClick:async()=>{x(t);const n=await async function(e){let{pageRuleID:t,domainID:a}=e;const n=new Z.Q.DeletePageRuleRequest({pageRuleID:t});return await(0,l.r)(n,{pathVars:{"{domain_id}":a}},(0,o.YT)(!1),(0,o.ZQ)())}({domainID:a,pageRuleID:e.pageRuleID});200===n?((0,M.yv)({variant:"success",message:"Successfully deleted page rule"}),s.emit(c.RulesChanged)):(0,M.yv)({variant:"warning",message:"Failed to delete page rule"}),x(void 0)}},React.createElement(ue.Z,{style:{color:R.palette.error.main}}))),React.createElement(S.Z,{title:"Move up for earlier evaluation"},React.createElement(W.Z,{onClick:()=>z(t,Re.Up)},React.createElement(de.Z,null))),React.createElement(S.Z,{title:"Move down for later evaluation"},React.createElement(W.Z,{onClick:()=>z(t,Re.Down)},React.createElement(pe.Z,null)))));var n})))))),React.createElement(re.Z,{page:y,rowsPerPage:h,component:"div",count:null!==(t=null==i?void 0:i.length)&&void 0!==t?t:0,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:e=>E(e.target.value),onPageChange:(e,t)=>v(t)})))}var fe=a(58268),Ee=a(96027),ye=a(41740),ve=a(79312),be=a(33952);const Ze=a.p+"20890b7f73bb102054f0.svg";function xe(e){let{open:t,onClose:a,title:n,message:i,onUpgrade:o}=e;return React.createElement(fe.Z,{open:t,sx:{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},onClose:a},React.createElement(Ee.Z,{sx:{p:3,width:600,textAlign:"center"}},React.createElement(ye.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},React.createElement("img",{src:Ze,height:100,width:100,alt:"Chat Icon",style:{marginTop:"30px"}}),React.createElement(ve.Z,{variant:"h6",color:"textPrimary",gutterBottom:!0,sx:{mb:5}},n)),React.createElement(ve.Z,{align:"center",fontSize:14,color:"textSecondary",sx:{mb:2}},i),React.createElement(ye.Z,{sx:{display:"flex",justifyContent:"space-evenly",gap:2,width:"100%",fontWeight:"bold"}},React.createElement(be.Z,{variant:"outlined",sx:{width:"100%",py:1},onClick:()=>{a()}},"Cancel"),React.createElement(be.Z,{variant:"contained",sx:{width:"100%",py:1},onClick:()=>{o()}},"Upgrade Now"))))}const ze=function(e){let{domainID:t,miniMode:a}=e;const[i,r]=(0,n.useState)(),[m,u]=(0,n.useState)(),[d,p]=(0,n.useState)("Add Rule"),[g,R]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1),[E,y]=(0,n.useState)(!1),[v,b]=(0,n.useState)(!1),[z,w]=(0,n.useState)(new Z.Q.PageRule({optimizations:new Z.Q.Optimizations,contentNature:Z.Q.ContentNature.Static}));return(0,n.useEffect)((()=>{async function e(e){e?f(!0):R(!0);const[a,n]=await async function(e){const[t,a]=await(0,l.YE)({pathVars:{"{domain_id}":e}},(0,o.YT)(!1),(0,o.ZQ)());return[t,a]}(t);if(200!==n&&204!==n)return;const i=a.pageRules.find((e=>"*"===e.pathPattern)),c=a.pageRules.filter((e=>"*"!==e.pathPattern)).sort(((e,t)=>e.priority-t.priority));r(i),u(c),e?f(!1):R(!1)}return e(),s.on(c.PriorityChanged,(e=>{const t=[];e.map((e=>{t.push(Z.Q.PageRule.fromObject(e))})),u(t)})),s.on(c.RulesChanged,(()=>{e(!0)})),()=>{s.off(c.PriorityChanged),s.off(c.RulesChanged)}}),[t]),(0,n.useEffect)((()=>(s.on(c.AddOrUpdatePageRuleAction,(e=>{e?(p("Edit Rule"),w(Z.Q.PageRule.fromObject(e)),(0,G.Tf)("adv_rule_edit_start")):(0,G.Tf)("adv_rule_add_start"),y(!0)})),()=>{s.off(c.AddOrUpdatePageRuleAction)})),[]),React.createElement(React.Fragment,null,(i||g)&&React.createElement(J,{pageRule:i,isLoading:g,domainID:t,isPageRulesListModified:h,miniMode:a,overrideRules:null!=m?m:[],openAddRule:()=>s.emit(c.AddOrUpdatePageRuleAction)}),React.createElement(xe,{title:"Upgrade Required",message:"You have reached the maximum page rules limit. Please upgrade to use more page rules.",open:v,onClose:()=>{b(!1)},onUpgrade:()=>{window.open("https://rabbitloader.com/pricing/?utm_source=panel&utm_medium=popup&utm_term=PageRulesLimit","_blank"),b(!1)}}),E&&React.createElement(ee,{open:E,onClose:()=>{y(!1),w(new Z.Q.PageRule({optimizations:new Z.Q.Optimizations,contentNature:Z.Q.ContentNature.Static})),p("Add Rule")},title:d,pageRule:z,onSubmit:async e=>{if(!e.pathPattern)return(0,M.yv)({variant:"error",message:"Path pattern is required!"}),!1;(0,G.Tf)("adv_rule_saved");const a=await x(t,e);return 402===a?(b(!0),!1):((0,M.yv)({variant:200===a?"success":"error",message:200===a?"Successfully saved optimization rule!":"Failed to save the settings!"}),200===a)}}),!a&&!(m&&m.length<=0)&&React.createElement(he,{domainID:t,pageRules:m,defaultPageRule:i,isLoading:g}))};var we=a(55312),Se=a(8120),Ce=a(67485);function Pe(e){let{id:t,domainID:a,miniMode:o}=e;return"local-testing-root"===t&&(0,i.createRoot)(document.getElementById("local-testing-root")).render(React.createElement(n.StrictMode,null,React.createElement(Se.mu,{defaultSettings:{themeMode:"light",themeDirection:"ltr",themeContrast:"default",themeLayout:"vertical",themeColorPresets:"blue",themeStretch:!1}},React.createElement("div",{style:{all:"unset",boxSizing:"border-box",borderStyle:"unset",border:"unset"}},React.createElement(we.Z,null,React.createElement(Ce.wT,null,React.createElement(ze,{domainID:a,miniMode:o}))))))),React.createElement(Se.mu,{defaultSettings:{themeMode:"light",themeDirection:"ltr",themeContrast:"default",themeLayout:"vertical",themeColorPresets:"blue",themeStretch:!1}},React.createElement(we.Z,null,React.createElement(Ce.wT,null,React.createElement(ze,{domainID:a,miniMode:o}))))}a(2845).$g.configure((e=>"rl-mfe-pr ".concat(e)))},89621:(e,t,a)=>{e.exports=a.p+"e503aec708eb2a9768c7.svg"}}]);